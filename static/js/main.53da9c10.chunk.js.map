{"version":3,"sources":["reducers/modules sync nonrecursive //.js$","reducers/modules/index.test.js","actions sync nonrecursive //.js$","actions/index.test.js","registerServiceWorker.js","reducers/index.js","components/VolumeMeter/Meter/index.js","components/Recorder/index.js","components/VolumeMeter/index.js","components/MenuAppBar/RegisterSpeaker/Record/index.js","components/MenuAppBar/RegisterSpeaker/index.js","components/MenuAppBar/index.js","components/Footer/index.js","components/AppTextArea/index.js","components/App/index.js","index.js","actions/Recorder.js","actions/index.js","reducers/modules/Recorder.js","reducers/modules/LoginManager.js","reducers/modules/ASR.js","reducers/modules/Host.js","actions/LoginManager.js","reducers/modules/index.js","actions/ASR.js"],"names":["map","./ASR.js","./Host.js","./LoginManager.js","./Recorder.js","./index.js","./index.test.js","webpackContext","req","id","webpackContextResolve","__webpack_require__","e","Error","code","keys","Object","resolve","module","exports","describe","it","expect","ASR","undefined","toEqual","verified","expired","Date","type","LoginManager","logined","action","fbid","email","name","hasivector","assign","_home_mino_github_VAWSR_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_0__","stream","test","Recorder","record","Host","hostname","expectedAction","user","isLocalhost","Boolean","window","location","match","registerValidSW","swUrl","navigator","serviceWorker","register","then","registration","onupdatefound","installingWorker","installing","onstatechange","state","controller","console","log","catch","error","combineReducers","modules","Slider","styled","div","_templateObject","Bar","_templateObject2","BarFill","_templateObject3","Track","_templateObject4","Grabber","_templateObject5","Meter","_this$props","this","props","width","threshold","handleMouse","react_default","a","createElement","style","background","position","top","onMouseDown","left","React","Component","_this","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","componentDidMount","recorder","MediaStreamRecorder","mimeType","audioChannels","ondataavailable","blob","stop","handleBlob","setState","ready","componentDidUpdate","prevProps","start","fd","FormData","append","axios","post","res","data","_ref","SpeakerRecognition","finally","handleStop","stopRecord","connect","dispatch","bindActionCreators","VolumeMeter","loop","analyser","getByteTimeDomainData","array","percentage","float","rms","db","total","i","length","Math","sqrt","log10","max","min","volume","Number","toFixed","startRecord","_this$state","document","addEventListener","handleMouseMove","handleMouseUp","event","clientX","node","offsetLeft","offsetWidth","clientWidth","removeEventListener","cookie","set","AudioContext","webkitAudioContext","audioContext","src","Cookies","_this2","updateStream","mediaDevices","getUserMedia","audio","prevState","createMediaStreamSource","setupAnalyser","get","_this$state2","createAnalyser","Uint8Array","frequencyBinCount","setInterval","_this3","_this$state3","ref","VolumeMeter_Meter","components_Recorder","Record","handleURL","startRecording","stopRecording","classes","className","Button_default","button","variant","color","onClick","disabled","Stop_default","Mic_default","withStyles","theme","margin","spacing","unit","Transition","Slide_default","direction","RegisterSpeaker","_React$Component","_getPrototypeOf2","_len","arguments","args","Array","_key","apply","concat","open","sentences","audioBlob","step","loading","handleClick","generateSentences","handleClose","callback","handleBack","handleNext","headers","Content-Type","toast","success","obj","replayBlob","blobURL","URL","createObjectURL","Audio","play","inherits","createClass","key","value","MenuItem_default","Dialog_default","fullScreen","onClose","TransitionComponent","AppBar_default","appBar","Toolbar_default","IconButton_default","aria-label","Close_default","Typography_default","flex","autoFocus","CircularProgress_default","size","buttonProgress","DialogTitle_default","DialogContent_default","DialogContentText_default","RegisterSpeaker_Record","PlayArrow_default","green","marginTop","marginLeft","defaults","withCredentials","PrimarySearchAppBar","anchorEl","handleProfileMenuOpen","currentTarget","handleMenuClose","handleLogin","login","token","accessToken","signed","signedRequest","POSITION","BOTTOM_RIGHT","handleLogout","_this$props2","logout","warn","_this$props3","_this$props4","isMenuOpen","renderMenu","Menu_default","anchorOrigin","vertical","horizontal","transformOrigin","facebook_login_render_props_default","appId","fields","disableMobileRedirect","render","renderProps","MenuAppBar_RegisterSpeaker","root","menuButton","icons_Menu_default","title","noWrap","search","searchIcon","Search_default","InputBase_default","placeholder","inputRoot","input","inputInput","grow","sectionDesktop","aria-owns","aria-haspopup","Avatar_default","alt","AccountCircle_default","sectionMobile","flexGrow","marginRight","defineProperty","display","breakpoints","up","borderRadius","shape","backgroundColor","fade","palette","common","white","&:hover","height","pointerEvents","alignItems","justifyContent","paddingTop","paddingRight","paddingBottom","paddingLeft","transition","transitions","create","Footer","TextArea","AppTextArea_templateObject","AppTextArea","AppWrapper","App_templateObject","App","MenuAppBar","components_AppTextArea","components_VolumeMeter","components_Footer","lib","createMuiTheme","typography","useNextVariants","store","createStore","reducers","__REDUX_DEVTOOLS_EXTENSION__","ReactDOM","es","core_styles","BrowserRouter","components_App","getElementById","process","origin","fetch","response","status","indexOf","unregister","reload","checkValidServiceWorker","registerServiceWorker","r","__webpack_exports__","d","files","require","forEach","replace","default"],"mappings":"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","file":"static/js/main.53da9c10.chunk.js","sourcesContent":["var map = {\n\t\"./ASR.js\": 66,\n\t\"./Host.js\": 67,\n\t\"./LoginManager.js\": 50,\n\t\"./Recorder.js\": 43,\n\t\"./index.js\": 87,\n\t\"./index.test.js\": 160\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tvar id = map[req];\n\tif(!(id + 1)) { // check for number or string\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn id;\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 159;","import ASR from './ASR'\nimport LoginManager from './LoginManager'\nimport Recorder from './Recorder'\nimport Host from './Host'\n\ndescribe('ASR reducer', () => {\n  it('should return the initial state', () => {\n    const initialState = { verified: false }\n    expect(ASR(undefined, {})).toEqual(initialState)\n  })\n\n  it('should handle SPEAKER_RECONGNITION', () => {\n    const expired = new Date()\n    expect(\n      ASR([], {\n        type: 'SPEAKER_RECONGNITION',\n        expired\n      })\n    ).toEqual({\n      verified: true,\n      expired\n    })\n  })\n})\n\ndescribe('LoginManager reducer', () => {\n  it('should retrun inital state', () => {\n    const initialState = { logined: false }\n    expect(LoginManager(undefined, {})).toEqual(initialState)\n  })\n\n  it('should handle LOGIN', () => {\n    const action = {\n      fbid: 1,\n      email: 'test',\n      name: 'test',\n      hasivector: false\n    }\n    expect(\n      LoginManager(undefined, Object.assign({ type: 'LOGIN' }, action))\n    ).toEqual({\n      logined: true,\n      ...action\n    })\n  })\n\n  it('should handle LOGOUT', () => {\n    expect(LoginManager(undefined, { type: 'LOGOUT' })).toEqual({\n      logined: false\n    })\n  })\n})\n\ndescribe('Recorder reducer', () => {\n  const stream = { test: 'test' }\n  it('should retrun inital state', () => {\n    const initialState = { record: false }\n    expect(Recorder(undefined, {})).toEqual(initialState)\n  })\n\n  it('should handle UPDATE_STREAM', () => {\n    expect(Recorder(undefined, { type: 'UPDATE_STREAM', stream })).toEqual({\n      record: false,\n      stream\n    })\n  })\n\n  it('should handle START_RECORD', () => {\n    expect(Recorder({ stream }, { type: 'START_RECORD' })).toEqual({\n      record: true,\n      stream\n    })\n  })\n\n  it('should handle STOP_RECORD', () => {\n    expect(Recorder({ stream }, { type: 'STOP_RECORD' })).toEqual({\n      record: false,\n      stream\n    })\n  })\n})\n\ndescribe('Host reducer', () => {\n  it('should retrun inital state', () => {\n    const initialState = { hostname: 'https://vawsr.mino.tw' }\n    expect(Host(undefined, {})).toEqual(initialState)\n  })\n\n  it('should handle CHANGE_HOST', () => {\n    const action = {\n      type: 'CHANGE_HOST',\n      hostname: 'https://test'\n    }\n    expect(Host(undefined, action)).toEqual({\n      hostname: 'https://test'\n    })\n  })\n})\n","var map = {\n\t\"./ASR.js\": 88,\n\t\"./LoginManager.js\": 70,\n\t\"./Recorder.js\": 33,\n\t\"./index.js\": 37,\n\t\"./index.test.js\": 163\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tvar id = map[req];\n\tif(!(id + 1)) { // check for number or string\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn id;\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 162;","import * as ASR from './ASR'\nimport * as LoginManager from './LoginManager'\nimport * as Recorder from './Recorder'\n\ndescribe('actions', () => {\n  it('should create an action to SpeakerRecognition', () => {\n    const expired = new Date()\n    const expectedAction = {\n      type: 'SPEAKER_RECOGNITION',\n      expired\n    }\n    expect(ASR.SpeakerRecognition(expired)).toEqual(expectedAction)\n  })\n\n  it('should create an action to login', () => {\n    const user = {\n      fbid: 1,\n      email: 'test',\n      name: 'test',\n      hasivector: 'test'\n    }\n    const expectedAction = {\n      type: 'LOGIN',\n      ...user\n    }\n    expect(LoginManager.login(user)).toEqual(expectedAction)\n  })\n\n  it('should create an action to logout', () => {\n    const expectedAction = {\n      type: 'LOGOUT'\n    }\n    expect(LoginManager.logout()).toEqual(expectedAction)\n  })\n\n  it('should create an action to startRecord', () => {\n    const expectedAction = {\n      type: 'START_RECORD'\n    }\n    expect(Recorder.startRecord()).toEqual(expectedAction)\n  })\n\n  it('should create an action to stopRecord', () => {\n    const expectedAction = {\n      type: 'STOP_RECORD'\n    }\n    expect(Recorder.stopRecord()).toEqual(expectedAction)\n  })\n\n  it('should create an action to updateStream', () => {\n    const stream = {}\n    const expectedAction = {\n      type: 'UPDATE_STREAM',\n      stream\n    }\n    expect(Recorder.updateStream(stream)).toEqual(expectedAction)\n  })\n})\n","// In production, we register a service worker to serve assets from local cache.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on the \"N+1\" visit to a page, since previously\n// cached resources are updated in the background.\n\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\n// This link also includes instructions on opting out of this behavior.\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n)\n\nexport default function register() {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location)\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebookincubator/create-react-app/issues/2374\n      return\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`\n\n      if (isLocalhost) {\n        // This is running on localhost. Lets check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl)\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ'\n          )\n        })\n      } else {\n        // Is not local host. Just register service worker\n        registerValidSW(swUrl)\n      }\n    })\n  }\n}\n\nfunction registerValidSW(swUrl) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the old content will have been purged and\n              // the fresh content will have been added to the cache.\n              // It's the perfect time to display a \"New content is\n              // available; please refresh.\" message in your web app.\n              console.log('New content is available; please refresh.')\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.')\n            }\n          }\n        }\n      }\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error)\n    })\n}\n\nfunction checkValidServiceWorker(swUrl) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      if (\n        response.status === 404 ||\n        response.headers.get('content-type').indexOf('javascript') === -1\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload()\n          })\n        })\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl)\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      )\n    })\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister()\n    })\n  }\n}\n","import modules from './modules'\nimport { combineReducers } from 'redux'\n\nexport default combineReducers(modules)\n","import React from 'react'\nimport styled from 'styled-components'\nimport PropTypes from 'prop-types'\n\nconst Slider = styled.div`\n  height: 40px;\n  position: relative;\n  width: 100%;\n`\n\nconst Bar = styled.div`\n  border-radius: 4px;\n  display: block;\n  height: 8px;\n  overflow: hidden;\n  position: relative;\n  top: 16px;\n  width: 100%;\n`\nconst BarFill = styled.div`\n  height: 100%;\n  background: rgba(0, 0, 0, 0.25);\n  transition: width 35ms ease;\n`\n\nconst Track = styled.div`\n  position: absolute;\n  top: 0px;\n  bottom: 0px;\n  right: 5px;\n  left: 5px;\n`\n\nconst Grabber = styled.div`\n  background: #fff;\n  border: 1px solid #dcddde;\n  position: absolute;\n  border-radius: 3px;\n  box-shadow: 0 3px 1px 0 rgba(0, 0, 0, 0.05), 0 2px 2px 0 rgba(0, 0, 0, 0.1),\n    0 3px 3px 0 rgba(0, 0, 0, 0.05);\n  cursor: ew-resize;\n  height: 24px;\n  left: 0px;\n  margin-left: -5px;\n  margin-top: -13px;\n  top: 50%;\n  width: 10px;\n`\n\nclass Meter extends React.Component {\n  static propTypes = {\n    threshold: PropTypes.number.isRequired,\n    width: PropTypes.number.isRequired,\n    handleMouse: PropTypes.func.isRequired\n  }\n\n  render() {\n    const { width, threshold, handleMouse } = this.props\n    return (\n      <Slider>\n        <Bar\n          style={{ background: 'rgb(105, 196, 154) none repeat scroll 0% 0%' }}>\n          <BarFill\n            style={{\n              width: threshold + '%',\n              background: 'rgb(251, 184, 72) none repeat scroll 0% 0%'\n            }}\n          />\n        </Bar>\n        <Bar\n          style={{\n            position: 'absolute',\n            top: '16px',\n            background: 'transparent'\n          }}>\n          <BarFill style={{ width: width + '%' }} />\n        </Bar>\n        <Track onMouseDown={handleMouse}>\n          <Grabber\n            onMouseDown={handleMouse}\n            style={{ left: threshold + '%' }}\n          />\n        </Track>\n      </Slider>\n    )\n  }\n}\n\nexport default Meter\n","import { connect } from 'react-redux'\nimport MediaStreamRecorder from 'msr'\nimport PropTypes from 'prop-types'\nimport React from 'react'\nimport { SpeakerRecognition, stopRecord } from '../../actions'\nimport { bindActionCreators } from 'redux'\nimport axios from 'axios'\n\nclass Recorder extends React.Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      ready: false,\n      record: false\n    }\n  }\n\n  componentDidMount = () => {\n    const { stream } = this.props\n    this.recorder = new MediaStreamRecorder(stream)\n    this.recorder.mimeType = 'audio/wav'\n    this.recorder.audioChannels = 1\n    this.recorder.ondataavailable = blob => {\n      this.recorder.stop()\n      this.handleBlob(blob)\n    }\n    this.setState({ ready: true })\n  }\n  componentDidUpdate = prevProps => {\n    const { record } = this.props\n    if (prevProps.record === record) {\n      return\n    }\n    if (record && !this.state.record) {\n      this.setState({ record: true })\n      this.recorder.start(4000)\n    }\n  }\n\n  handleBlob = blob => {\n    var fd = new FormData()\n    fd.append('file', blob, 'file.wav')\n    axios\n      .post('https://vawsr.mino.tw/sr', fd)\n      .then(res => res.data)\n      .then(({ expired }) => {\n        this.props.SpeakerRecognition(expired)\n      })\n      .catch(() => console.log('recognition failed'))\n      .finally(() => this.handleStop())\n  }\n  handleStop = () => {\n    this.recorder.stop()\n    this.setState({ record: false })\n    this.props.stopRecord()\n  }\n  render() {\n    return <div />\n  }\n}\n\nRecorder.propTypes = {\n  stream: PropTypes.object.isRequired,\n  record: PropTypes.bool.isRequired,\n  SpeakerRecognition: PropTypes.func,\n  stopRecord: PropTypes.func\n}\n\nconst mapStateToProps = state => {\n  return {\n    record: state.Recorder.record,\n    stream: state.Recorder.stream\n  }\n}\n\nconst mapDispatchToProps = dispatch => {\n  return bindActionCreators(\n    {\n      SpeakerRecognition,\n      stopRecord\n    },\n    dispatch\n  )\n}\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Recorder)\n","import React from 'react'\nimport Meter from './Meter'\nimport Cookies from 'universal-cookie'\nimport { connect } from 'react-redux'\nimport { bindActionCreators } from 'redux'\nimport PropTypes from 'prop-types'\nimport Recorder from '../Recorder'\nimport { startRecord, updateStream } from '../../actions/Recorder'\n\nclass VolumeMeter extends React.Component {\n  constructor(props) {\n    super(props)\n    window.AudioContext = window.AudioContext || window.webkitAudioContext\n    this.state = {\n      audioContext: new AudioContext(),\n      src: null,\n      volume: 0,\n      threshold: 50,\n      stream: false\n    }\n    this.cookie = new Cookies()\n  }\n\n  componentDidMount() {\n    const { updateStream } = this.props\n    navigator.mediaDevices.getUserMedia({ audio: true }).then(stream => {\n      updateStream(stream)\n      this.setState(prevState => ({\n        src: prevState.audioContext.createMediaStreamSource(stream),\n        stream: stream\n      }))\n      this.setupAnalyser()\n    })\n    let threshold = this.cookie.get('threshold')\n    if (threshold !== undefined && Number(threshold)) {\n      this.setState({ threshold: Number(threshold) })\n    }\n  }\n\n  setupAnalyser() {\n    const { audioContext, src } = this.state\n    this.analyser = audioContext.createAnalyser()\n    src.connect(this.analyser)\n    this.array = new Uint8Array(this.analyser.frequencyBinCount)\n    setInterval(this.loop, 1000 / 10)\n  }\n\n  loop = () => {\n    this.analyser.getByteTimeDomainData(this.array)\n    var total = 0,\n      i = 0,\n      percentage,\n      float,\n      rms,\n      db\n    while (i < this.array.length) {\n      float = this.array[i++] / 0x80 - 1\n      total += float * float\n    }\n    rms = Math.sqrt(total / this.array.length)\n    db = 20 * Math.log10(rms)\n    db = Math.max(-48, Math.min(db, 0))\n    percentage = 100 + db * 2.083\n    this.setState({\n      volume: Number(percentage.toFixed(2))\n    })\n    const { startRecord, record, logined } = this.props\n    const { stream, threshold } = this.state\n    if (logined && stream && percentage >= threshold && !record) {\n      startRecord()\n    }\n  }\n\n  handleMouse = () => {\n    document.addEventListener('mousemove', this.handleMouseMove, true)\n    document.addEventListener('mouseup', this.handleMouseUp, true)\n  }\n  handleMouseMove = event => {\n    let threshold\n    if (event.clientX < this.node.offsetLeft) {\n      threshold = 0\n    } else if (event.clientX > this.node.offsetWidth + this.node.offsetLeft) {\n      threshold = (this.node.offsetWidth / this.node.clientWidth) * 100\n    } else {\n      threshold =\n        ((event.clientX - this.node.offsetLeft) / this.node.clientWidth) * 100\n    }\n\n    this.setState({\n      threshold: threshold\n    })\n  }\n  handleMouseUp = event => {\n    document.removeEventListener('mousemove', this.handleMouseMove, true)\n    document.removeEventListener('mouseup', this.handleMouseUp, true)\n    let threshold\n    if (event.clientX < this.node.offsetLeft) {\n      threshold = 0\n    } else if (event.clientX > this.node.offsetWidth + this.node.offsetLeft) {\n      threshold = (this.node.offsetWidth / this.node.clientWidth) * 100\n    } else {\n      threshold =\n        ((event.clientX - this.node.offsetLeft) / this.node.clientWidth) * 100\n    }\n\n    this.setState({\n      threshold: threshold\n    })\n    this.cookie.set('threshold', threshold)\n  }\n\n  render() {\n    let { volume, threshold, stream } = this.state\n    let { logined } = this.props\n    return (\n      <div ref={node => (this.node = node)}>\n        <Meter\n          handleMouse={this.handleMouse}\n          threshold={threshold}\n          width={volume}\n        />\n        {logined && stream && <Recorder />}\n      </div>\n    )\n  }\n}\n\nVolumeMeter.propTypes = {\n  startRecord: PropTypes.func.isRequired,\n  updateStream: PropTypes.func.isRequired,\n  record: PropTypes.bool.isRequired,\n  logined: PropTypes.bool.isRequired\n}\n\nconst mapStateToProps = state => {\n  return {\n    record: state.Recorder.record,\n    logined: state.LoginManager.logined\n  }\n}\n\nconst mapDispatchToProps = dispatch => {\n  return bindActionCreators(\n    {\n      startRecord,\n      updateStream\n    },\n    dispatch\n  )\n}\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(VolumeMeter)\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport { withStyles } from '@material-ui/core/styles'\nimport Button from '@material-ui/core/Button'\nimport Mic from '@material-ui/icons/Mic'\nimport Stop from '@material-ui/icons/Stop'\nimport MediaStreamRecorder from 'msr'\nimport { connect } from 'react-redux'\n\nconst styles = theme => ({\n  button: {\n    margin: theme.spacing.unit,\n    float: 'right'\n  },\n  record: {\n    margin: '10px 0px'\n  }\n})\n\nclass Record extends React.Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      record: false,\n      ready: false\n    }\n  }\n\n  componentDidMount = () => {\n    const { stream } = this.props\n    this.recorder = new MediaStreamRecorder(stream)\n    this.recorder.mimeType = 'audio/wav'\n    this.recorder.audioChannels = 1\n    this.recorder.ondataavailable = blob => {\n      this.props.handleURL(blob)\n    }\n    this.setState({ ready: true })\n  }\n  startRecording = () => {\n    this.setState({\n      record: true\n    })\n    this.recorder.start(100000)\n  }\n\n  stopRecording = () => {\n    this.setState({\n      record: false\n    })\n    this.recorder.stop()\n  }\n\n  render() {\n    const { classes } = this.props\n    return (\n      <div className={classes.record}>\n        <Button\n          className={classes.button}\n          variant=\"fab\"\n          color=\"secondary\"\n          onClick={this.state.record ? this.stopRecording : this.startRecording}\n          type=\"button\"\n          disabled={!this.state.ready}>\n          {this.state.record ? <Stop /> : <Mic />}\n        </Button>\n      </div>\n    )\n  }\n}\n\nRecord.propTypes = {\n  classes: PropTypes.object.isRequired,\n  handleURL: PropTypes.func.isRequired,\n  stream: PropTypes.object.isRequired\n}\n\nconst mapStateToProps = state => {\n  return {\n    stream: state.Recorder.stream\n  }\n}\n\nexport default connect(mapStateToProps)(withStyles(styles)(Record))\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Button from '@material-ui/core/Button'\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport DialogContentText from '@material-ui/core/DialogContentText'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport PlayArrow from '@material-ui/icons/PlayArrow'\nimport { withStyles } from '@material-ui/core/styles'\nimport MenuItem from '@material-ui/core/MenuItem'\nimport AppBar from '@material-ui/core/AppBar'\nimport Toolbar from '@material-ui/core/Toolbar'\nimport IconButton from '@material-ui/core/IconButton'\nimport Typography from '@material-ui/core/Typography'\nimport CloseIcon from '@material-ui/icons/Close'\nimport green from '@material-ui/core/colors/green'\nimport CircularProgress from '@material-ui/core/CircularProgress'\nimport Slide from '@material-ui/core/Slide'\nimport { connect } from 'react-redux'\nimport { toast } from 'react-toastify'\nimport axios from 'axios'\n\nimport Record from './Record'\n\nconst styles = theme => ({\n  button: {\n    margin: theme.spacing.unit,\n    float: 'right'\n  },\n  buttonProgress: {\n    color: green[500],\n    position: 'absolute',\n    top: '50%',\n    left: '50%',\n    marginTop: -12,\n    marginLeft: -12\n  },\n  appBar: {\n    position: 'relative'\n  },\n  flex: {\n    flex: 1\n  }\n})\n\nfunction Transition(props) {\n  return <Slide direction=\"up\" {...props} />\n}\n\nexport class RegisterSpeaker extends React.Component {\n  state = {\n    open: false,\n    sentences: [],\n    audioBlob: {},\n    audio: [],\n    step: 0,\n    loading: false\n  }\n\n  handleClick = () => {\n    this.generateSentences()\n    this.setState({ open: true })\n  }\n\n  handleClose = () => {\n    const { callback } = this.props\n    this.setState({ open: false })\n    callback()\n  }\n\n  handleBack = () => {\n    if (this.state.step > 0) {\n      this.setState(prevState => ({ step: prevState.step - 1 }))\n    } else {\n      this.handleClose()\n    }\n  }\n\n  handleNext = () => {\n    if (this.state.step < 2) {\n      this.setState(prevState => ({ step: prevState.step + 1 }))\n    } else {\n      const { hostname } = this.props\n      this.setState({ loading: true })\n      var fd = new FormData()\n      // eslint-disable-next-line\n      for(let i = 0; i < 3; i++){\n        fd.append(`file${i + 1}`, this.state.audioBlob[i], `file${i + 1}.wav`)\n      }\n      axios\n        .post(`${hostname}/registerspeaker`, fd, {\n          headers: {\n            'Content-Type': 'multipart/form-data'\n          }\n        })\n        .then(() => {\n          toast.success('語者註冊成功')\n          this.handleClose()\n        })\n        .catch(() => {\n          toast.error('語者註冊失敗，請重新傳送一遍')\n          this.setState({ loading: false })\n        })\n    }\n  }\n\n  handleURL = blob => {\n    let obj = {}\n    obj[this.state.step] = blob\n\n    this.setState(prevState => ({\n      audioBlob: Object.assign({}, prevState.audioBlob, obj)\n    }))\n  }\n\n  replayBlob = () => {\n    var blobURL = window.URL.createObjectURL(\n      this.state.audioBlob[this.state.step]\n    )\n    var audio0 = new Audio(blobURL)\n    audio0.play()\n  }\n\n  generateSentences = () => {\n    const { hostname } = this.props\n    axios\n      .get(`${hostname}/sentences.json`)\n      .then(res => res.data)\n      .then(({ sentences }) => {\n        this.setState({ sentences: sentences })\n      })\n      .catch(() => {\n        toast.error('取得語料失敗，請檢查登入是否過期')\n        this.handleClose()\n      })\n  }\n\n  render() {\n    const { classes, hasivector } = this.props\n    const { loading, step, sentences, audioBlob, open } = this.state\n    return (\n      <div>\n        <MenuItem onClick={this.handleClick}>\n          <p>{hasivector ? '重新註冊語者' : '語者設定'}</p>\n        </MenuItem>\n        <Dialog\n          fullScreen\n          open={open}\n          onClose={this.handleClose}\n          TransitionComponent={Transition}>\n          <AppBar className={classes.appBar}>\n            <Toolbar>\n              <IconButton\n                color=\"inherit\"\n                onClick={this.handleClose}\n                aria-label=\"Close\">\n                <CloseIcon />\n              </IconButton>\n              <Typography variant=\"h6\" color=\"inherit\" className={classes.flex}>\n                語者設定\n              </Typography>\n              <Button onClick={this.handleBack} color=\"inherit\">\n                Back\n              </Button>\n              <Button\n                onClick={this.handleNext}\n                color=\"inherit\"\n                autoFocus\n                disabled={!audioBlob[step] || loading}>\n                {step === 2 ? 'Finish' : 'Next'}\n                {loading && (\n                  <CircularProgress\n                    size={24}\n                    className={classes.buttonProgress}\n                  />\n                )}\n              </Button>\n            </Toolbar>\n          </AppBar>\n          <DialogTitle id=\"responsive-dialog-title\">\n            {'請朗讀下列文字進行語者註冊'}\n          </DialogTitle>\n          <DialogContent>\n            <DialogContentText id=\"sentences\">\n              {sentences[step]}\n            </DialogContentText>\n            <Record handleURL={this.handleURL} />\n            <Button\n              disabled={!audioBlob[step]}\n              className={classes.button}\n              variant=\"fab\"\n              color=\"secondary\"\n              type=\"button\"\n              onClick={this.replayBlob}>\n              <PlayArrow />\n            </Button>\n          </DialogContent>\n        </Dialog>\n      </div>\n    )\n  }\n}\n\nRegisterSpeaker.propTypes = {\n  classes: PropTypes.object.isRequired,\n  callback: PropTypes.func.isRequired,\n  hasivector: PropTypes.bool.isRequired,\n  hostname: PropTypes.string.isRequired\n}\nconst mapStateToProps = state => {\n  return {\n    hasivector: state.LoginManager.hasivector,\n    hostname: state.Host.hostname\n  }\n}\n\nexport default connect(mapStateToProps)(withStyles(styles)(RegisterSpeaker))\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport AppBar from '@material-ui/core/AppBar'\nimport Toolbar from '@material-ui/core/Toolbar'\nimport IconButton from '@material-ui/core/IconButton'\nimport Typography from '@material-ui/core/Typography'\nimport InputBase from '@material-ui/core/InputBase'\nimport MenuItem from '@material-ui/core/MenuItem'\nimport Menu from '@material-ui/core/Menu'\nimport { fade } from '@material-ui/core/styles/colorManipulator'\nimport { withStyles } from '@material-ui/core/styles'\nimport MenuIcon from '@material-ui/icons/Menu'\nimport SearchIcon from '@material-ui/icons/Search'\nimport AccountCircle from '@material-ui/icons/AccountCircle'\nimport Avatar from '@material-ui/core/Avatar'\nimport { connect } from 'react-redux'\nimport { bindActionCreators } from 'redux'\nimport { toast } from 'react-toastify'\n\nimport FacebookLogin from 'react-facebook-login/dist/facebook-login-render-props'\nimport { login, logout } from '../../actions'\nimport RegisterSpeaker from './RegisterSpeaker'\nimport axios from 'axios'\n\naxios.defaults.withCredentials = true\n\nconst styles = theme => ({\n  root: {\n    width: '100%'\n  },\n  grow: {\n    flexGrow: 1\n  },\n  menuButton: {\n    marginLeft: -12,\n    marginRight: 20\n  },\n  title: {\n    display: 'none',\n    [theme.breakpoints.up('sm')]: {\n      display: 'block'\n    }\n  },\n  search: {\n    position: 'relative',\n    borderRadius: theme.shape.borderRadius,\n    backgroundColor: fade(theme.palette.common.white, 0.15),\n    '&:hover': {\n      backgroundColor: fade(theme.palette.common.white, 0.25)\n    },\n    marginRight: theme.spacing.unit * 2,\n    marginLeft: 0,\n    width: '100%',\n    [theme.breakpoints.up('sm')]: {\n      marginLeft: theme.spacing.unit * 3,\n      width: 'auto'\n    }\n  },\n  searchIcon: {\n    width: theme.spacing.unit * 9,\n    height: '100%',\n    position: 'absolute',\n    pointerEvents: 'none',\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center'\n  },\n  inputRoot: {\n    color: 'inherit',\n    width: '100%'\n  },\n  inputInput: {\n    paddingTop: theme.spacing.unit,\n    paddingRight: theme.spacing.unit,\n    paddingBottom: theme.spacing.unit,\n    paddingLeft: theme.spacing.unit * 10,\n    transition: theme.transitions.create('width'),\n    width: '100%',\n    [theme.breakpoints.up('md')]: {\n      width: 200\n    }\n  },\n  sectionDesktop: {\n    display: 'none',\n    [theme.breakpoints.up('md')]: {\n      display: 'flex'\n    }\n  },\n  sectionMobile: {\n    display: 'flex',\n    [theme.breakpoints.up('md')]: {\n      display: 'none'\n    }\n  }\n})\n\nclass PrimarySearchAppBar extends React.Component {\n  state = {\n    anchorEl: null\n  }\n\n  constructor(props) {\n    super(props)\n    const { hostname, login } = this.props\n    axios\n      .get(`${hostname}/auth`)\n      .then(res => res.data)\n      .then(data => {\n        login(data)\n        console.log('Auth success')\n      })\n      .catch(() => {\n        console.log('Auth failed')\n      })\n  }\n\n  handleProfileMenuOpen = event => {\n    this.setState({ anchorEl: event.currentTarget })\n  }\n\n  handleMenuClose = () => {\n    this.setState({ anchorEl: null })\n  }\n\n  handleLogin = res => {\n    const { hostname, login } = this.props\n    axios\n      .post(\n        `${hostname}/login`,\n        {\n          email: res.email,\n          name: res.name,\n          token: res.accessToken,\n          signed: res.signedRequest,\n          fbid: Number(res.id)\n        },\n        {\n          headers: {\n            'Content-Type': 'application/x-www-form-urlencoded'\n          }\n        }\n      )\n      .then(res => res.data)\n      .then(data => {\n        login(data)\n        toast.success('Login success', {\n          position: toast.POSITION.BOTTOM_RIGHT\n        })\n      })\n      .catch(() =>\n        toast.error('Login failed', {\n          position: toast.POSITION.BOTTOM_RIGHT\n        })\n      )\n      .finally(() => {\n        this.handleMenuClose()\n      })\n  }\n\n  handleLogout = () => {\n    const { logout, hostname } = this.props\n    axios.get(`${hostname}/logout`)\n    logout()\n    toast.warn('Logout success', { position: toast.POSITION.BOTTOM_RIGHT })\n    this.handleMenuClose()\n  }\n\n  render() {\n    const { anchorEl } = this.state\n    const { classes, logined, stream, user } = this.props\n    const isMenuOpen = Boolean(anchorEl)\n\n    const renderMenu = (\n      <Menu\n        anchorEl={anchorEl}\n        anchorOrigin={{ vertical: 'top', horizontal: 'right' }}\n        transformOrigin={{ vertical: 'top', horizontal: 'right' }}\n        open={isMenuOpen}\n        onClose={this.handleMenuClose}>\n        {logined ? (\n          <MenuItem onClick={this.handleLogout}>Logout</MenuItem>\n        ) : (\n          <FacebookLogin\n            appId=\"332358063993706\"\n            fields=\"name,email,picture\"\n            disableMobileRedirect={true}\n            callback={this.handleLogin}\n            render={renderProps => (\n              <MenuItem onClick={renderProps.onClick}>Facebook Login</MenuItem>\n            )}\n          />\n        )}\n        {logined && <RegisterSpeaker callback={this.handleMenuClose} />}\n      </Menu>\n    )\n\n    return (\n      <div className={classes.root}>\n        <AppBar position=\"static\">\n          <Toolbar>\n            <IconButton\n              className={classes.menuButton}\n              color=\"inherit\"\n              aria-label=\"Open drawer\">\n              <MenuIcon />\n            </IconButton>\n            <Typography\n              className={classes.title}\n              variant=\"h6\"\n              color=\"inherit\"\n              noWrap>\n              具語者辨識之語音助理\n            </Typography>\n            <div className={classes.search}>\n              <div className={classes.searchIcon}>\n                <SearchIcon />\n              </div>\n              <InputBase\n                placeholder=\"Search…\"\n                classes={{\n                  root: classes.inputRoot,\n                  input: classes.inputInput\n                }}\n              />\n            </div>\n            <div className={classes.grow} />\n            <div className={classes.sectionDesktop}>\n              <IconButton\n                aria-owns={isMenuOpen ? 'material-appbar' : null}\n                aria-haspopup=\"true\"\n                onClick={this.handleProfileMenuOpen}\n                color=\"inherit\">\n                {user.fbid ? (\n                  <Avatar\n                    alt={user.name}\n                    src={`https://graph.facebook.com/${\n                      user.fbid\n                    }/picture?type=normal`}\n                  />\n                ) : (\n                  <AccountCircle />\n                )}\n              </IconButton>\n            </div>\n            <div className={classes.sectionMobile}>\n              <IconButton\n                aria-owns={isMenuOpen ? 'material-appbar' : null}\n                aria-haspopup=\"true\"\n                onClick={this.handleProfileMenuOpen}\n                color=\"inherit\">\n                {user.fbid ? (\n                  <Avatar\n                    alt={user.name}\n                    src={`https://graph.facebook.com/${\n                      user.fbid\n                    }/picture?type=normal`}\n                  />\n                ) : (\n                  <AccountCircle />\n                )}\n              </IconButton>\n            </div>\n          </Toolbar>\n        </AppBar>\n        {stream && renderMenu}\n      </div>\n    )\n  }\n}\n\nPrimarySearchAppBar.propTypes = {\n  classes: PropTypes.object.isRequired,\n  logined: PropTypes.bool.isRequired,\n  user: PropTypes.object.isRequired,\n  hostname: PropTypes.string.isRequired,\n  login: PropTypes.func.isRequired,\n  logout: PropTypes.func.isRequired,\n  stream: PropTypes.object\n}\n\nconst mapStateToProps = state => {\n  return {\n    logined: state.LoginManager.logined,\n    hostname: state.Host.hostname,\n    user: state.LoginManager,\n    stream: state.Recorder.stream\n  }\n}\n\nconst mapDispatchToProps = dispatch => {\n  return bindActionCreators(\n    {\n      login,\n      logout\n    },\n    dispatch\n  )\n}\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(withStyles(styles)(PrimarySearchAppBar))\n","import React from 'react'\n\nclass Footer extends React.Component {\n  render() {\n    return (\n      <footer>\n        <p>© YunTech 2018</p>\n      </footer>\n    )\n  }\n}\n\nexport default Footer\n","import React, { Component } from 'react'\nimport styled from 'styled-components'\n\nconst TextArea = styled.div`\n  width: 100%;\n  height: 400px;\n  border-radius: 10px;\n  background: #eee;\n`\n\nclass AppTextArea extends Component {\n  render() {\n    return <TextArea />\n  }\n}\n\nexport default AppTextArea\n","import React, { Component } from 'react'\nimport styled from 'styled-components'\nimport VolumeMeter from '../VolumeMeter'\nimport MenuAppBar from '../MenuAppBar'\nimport Footer from '../Footer'\nimport AppTextArea from '../AppTextArea'\nimport { ToastContainer } from 'react-toastify'\nimport 'react-toastify/dist/ReactToastify.css'\n\nconst AppWrapper = styled.div`\n  text-align: center;\n  margin: 0px auto;\n`\n\nclass App extends Component {\n  render() {\n    return (\n      <AppWrapper>\n        <MenuAppBar />\n        <AppTextArea />\n        <VolumeMeter />\n        <Footer />\n        <ToastContainer />\n      </AppWrapper>\n    )\n  }\n}\n\nexport default App\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport { Provider } from 'react-redux'\nimport { createStore } from 'redux'\nimport './index.css'\nimport registerServiceWorker from './registerServiceWorker'\nimport reducers from './reducers'\nimport App from './components/App/'\nimport { BrowserRouter } from 'react-router-dom'\nimport { MuiThemeProvider, createMuiTheme } from '@material-ui/core/styles'\n\nconst theme = createMuiTheme({\n  typography: {\n    useNextVariants: true\n  }\n})\n\nlet store = createStore(\n  reducers,\n  window.__REDUX_DEVTOOLS_EXTENSION__ && window.__REDUX_DEVTOOLS_EXTENSION__()\n)\n\nReactDOM.render(\n  <Provider store={store}>\n    <MuiThemeProvider theme={theme}>\n      <BrowserRouter>\n        <App />\n      </BrowserRouter>\n    </MuiThemeProvider>\n  </Provider>,\n  document.getElementById('root')\n)\nregisterServiceWorker()\n","export const startRecord = () => {\n  return {\n    type: 'START_RECORD'\n  }\n}\n\nexport const stopRecord = () => {\n  return {\n    type: 'STOP_RECORD'\n  }\n}\n\nexport const updateStream = stream => {\n  return {\n    type: 'UPDATE_STREAM',\n    stream\n  }\n}\n","const files = require.context('.', false, /\\.js$/)\nconst modules = {}\n\nfiles.keys().forEach(key => {\n  if (key.match(/\\.\\/index.*js/)) return\n  Object.assign(modules, files(key))\n})\n\nmodule.exports = modules\n","const Recorder = (state = { record: false }, action) => {\n  switch (action.type) {\n    case 'UPDATE_STREAM':\n      return Object.assign({}, state, { stream: action.stream })\n    case 'START_RECORD':\n      return Object.assign({}, state, { record: true })\n    case 'STOP_RECORD':\n      return Object.assign({}, state, { record: false })\n\n    default:\n      return state\n  }\n}\n\nexport default Recorder\n","const LoginManager = (state = { logined: false }, action) => {\n  switch (action.type) {\n    case 'LOGIN':\n      return {\n        fbid: action.fbid,\n        email: action.email,\n        name: action.name,\n        logined: true,\n        hasivector: action.hasivector\n      }\n    case 'LOGOUT':\n      return { logined: false }\n\n    default:\n      return state\n  }\n}\n\nexport default LoginManager\n","const ASR = (state = { verified: false }, action) => {\n  switch (action.type) {\n    case 'SPEAKER_RECONGNITION':\n      return {\n        verified: true,\n        expired: action.expired\n      }\n    default:\n      return state\n  }\n}\n\nexport default ASR\n","const Host = (state = { hostname: 'https://vawsr.mino.tw' }, action) => {\n  switch (action.type) {\n    case 'CHANGE_HOST':\n      return Object.assign({}, state, { hostname: action.hostname })\n    default:\n      return state\n  }\n}\n\nexport default Host\n","export const login = user => {\n  return {\n    type: 'LOGIN',\n    fbid: user.fbid,\n    email: user.email,\n    name: user.name,\n    hasivector: user.hasivector\n  }\n}\n\nexport const logout = () => {\n  return {\n    type: 'LOGOUT'\n  }\n}\n","const files = require.context('.', false, /\\.js$/)\nconst modules = {}\n\nfiles.keys().forEach(key => {\n  if (key.match(/\\.\\/index.*js/)) return\n  modules[key.replace(/(\\.\\/|\\.js)/g, '')] = files(key).default\n})\n\nexport default modules\n","export const SpeakerRecognition = expired => {\n  return {\n    type: 'SPEAKER_RECOGNITION',\n    expired\n  }\n}\n"],"sourceRoot":""}