(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{103:function(e,t,n){"use strict";n.r(t);var a=n(200),o={};a.keys().forEach(function(e){e.match(/\.\/index\.js|.*\.test\.js/)||(o[e.replace(/(\.\/|\.js)/g,"")]=a(e).default)}),t.default=o},190:function(e,t,n){e.exports=n(421)},198:function(e,t,n){},200:function(e,t,n){var a={"./Host.js":77,"./Host.test.js":201,"./LoginManager.js":59,"./LoginManager.test.js":202,"./Recorder.js":35,"./Recorder.test.js":203,"./Websocket.js":36,"./Websocket.test.js":204,"./index.js":103};function o(e){var t=r(e);return n(t)}function r(e){var t=a[e];if(!(t+1)){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}return t}o.keys=function(){return Object.keys(a)},o.resolve=r,e.exports=o,o.id=200},201:function(e,t,n){"use strict";n.r(t);var a=n(77);describe("Host reducer",function(){it("should retrun inital state",function(){expect(Object(a.default)(void 0,{})).toEqual({hostname:"https://vawsr.mino.tw"})}),it("should handle CHANGE_HOST",function(){expect(Object(a.default)(void 0,{type:"CHANGE_HOST",hostname:"https://test"})).toEqual({hostname:"https://test"})})})},202:function(e,t,n){"use strict";n.r(t);var a=n(8),o=n(59);describe("LoginManager reducer",function(){var e={logined:!1,hasivector:!1,processing:!1};it("should retrun inital state",function(){expect(Object(o.default)(void 0,{})).toEqual(e)}),it("should handle LOGIN",function(){var e={fbid:1,email:"test",name:"test",hasivector:!1,processing:!1};expect(Object(o.default)(void 0,Object.assign({type:"LOGIN"},e))).toEqual(Object(a.a)({logined:!0},e))}),it("should handle LOGOUT",function(){expect(Object(o.default)({logined:!0},{type:"LOGOUT"})).toEqual({logined:!1,hasivector:!1,processing:!1})})})},203:function(e,t,n){"use strict";n.r(t);var a=n(8),o=n(35);describe("Recorder reducer",function(){var e={test:"test"},t={record:!1,suspended:!1};it("should retrun inital state",function(){expect(Object(o.default)(void 0,{})).toEqual(t)}),it("should handle UPDATE_STREAM",function(){expect(Object(o.default)(void 0,{type:"UPDATE_STREAM",stream:e})).toEqual(Object(a.a)({},t,{stream:e}))}),it("should handle START_RECORD",function(){expect(Object(o.default)(Object(a.a)({stream:e},t),{type:"START_RECORD"})).toEqual(Object(a.a)({},t,{record:!0,stream:e}))}),it("should handle STOP_RECORD",function(){expect(Object(o.default)(Object(a.a)({stream:e},t),{type:"STOP_RECORD"})).toEqual(Object(a.a)({},t,{record:!1,stream:e}))}),it("should handle SUSPEND_VOLUMEMETER",function(){expect(Object(o.default)(void 0,{type:"SUSPEND_VOLUMEMETER"})).toEqual(Object(a.a)({},t,{suspended:!0}))}),it("should handle RESUME_VOLUMEMETER",function(){expect(Object(o.default)(Object(a.a)({},t,{suspended:!0}),{type:"RESUME_VOLUMEMETER"})).toEqual(Object(a.a)({},t))})})},204:function(e,t,n){"use strict";n.r(t);var a=n(8),o=n(36);describe("Websocket reducer",function(){var e={connected:!1,responses:[],google:"",kaldi:""};it("should return the initial state",function(){expect(Object(o.default)(void 0,{})).toEqual(e)}),it("should handle ON_CONNECT",function(){expect(Object(o.default)(void 0,{type:"ON_CONNECT"})).toEqual(Object(a.a)({},e,{connected:!0}))}),it("should handle TRANSCRIPT_GOOGLE",function(){expect(Object(o.default)(void 0,{type:"TRANSCRIPT_GOOGLE",transcript_google:"test"})).toEqual(Object(a.a)({},e,{google:"test"}))}),it("should handle TRANSCRIPT_KALDI",function(){expect(Object(o.default)(void 0,{type:"TRANSCRIPT_KALDI",transcript_kaldi:"test"})).toEqual(Object(a.a)({},e,{kaldi:"test"}))}),it("should handle STOP_STREAM",function(){var t={text:"123",url:"456"},n=Object(a.a)({},e,{responses:[Object(a.a)({google:"google",kaldi:"kaldi",proba:.8},t)]});expect(Object(o.default)(void 0,Object(a.a)({type:"STOP_STREAM",google:"google",kaldi:"kaldi",proba:.8},t))).toEqual(n)}),it("should handle CLEAR_RESPONSES",function(){expect(Object(o.default)(Object(a.a)({},e,{responses:[1,2]}),{type:"CLEAR_RESPONSES"})).toEqual(e)})})},229:function(e,t){},35:function(e,t,n){"use strict";n.r(t);var a=n(8);t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{record:!1,suspended:!1},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_STREAM":return Object(a.a)({},e,{stream:t.stream});case"START_RECORD":return Object(a.a)({},e,{record:!0});case"STOP_RECORD":return Object(a.a)({},e,{record:!1});case"SUSPEND_VOLUMEMETER":return Object(a.a)({},e,{suspended:!0});case"RESUME_VOLUMEMETER":return Object(a.a)({},e,{suspended:!1});default:return e}}},36:function(e,t,n){"use strict";n.r(t);var a=n(8);t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{connected:!1,responses:[],google:"",kaldi:""},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ON_CONNECT":return Object(a.a)({},e,{connected:!0});case"TRANSCRIPT_GOOGLE":return Object(a.a)({},e,{google:t.transcript_google});case"TRANSCRIPT_KALDI":return Object(a.a)({},e,{kaldi:t.transcript_kaldi});case"STOP_STREAM":return e.responses.push({google:t.google,kaldi:t.kaldi,proba:t.proba,text:t.text,url:t.url}),Object(a.a)({},e,{google:"",kaldi:""});case"CLEAR_RESPONSES":return Object(a.a)({},e,{responses:[]});default:return e}}},421:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(24),i=n.n(r),s=n(23),c=n(22),l=(n(198),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)));function u(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(function(e){console.error("Error during service worker registration:",e)})}var d=n(103),p=Object(c.b)(d.default),h=n(15),f=n(16),m=n(18),g=n(17),b=n(19),v=n(28),O=n(29);function E(){var e=Object(v.a)(["\n  background: #fff;\n  border: 1px solid #dcddde;\n  position: absolute;\n  border-radius: 3px;\n  box-shadow: 0 3px 1px 0 rgba(0, 0, 0, 0.05), 0 2px 2px 0 rgba(0, 0, 0, 0.1),\n    0 3px 3px 0 rgba(0, 0, 0, 0.05);\n  cursor: ew-resize;\n  height: 24px;\n  left: 0px;\n  margin-left: -5px;\n  margin-top: -13px;\n  top: 50%;\n  width: 10px;\n"]);return E=function(){return e},e}function j(){var e=Object(v.a)(["\n  position: absolute;\n  top: 0px;\n  bottom: 0px;\n  right: 5px;\n  left: 5px;\n"]);return j=function(){return e},e}function y(){var e=Object(v.a)(["\n  height: 100%;\n  background: rgba(0, 0, 0, 0.25);\n  transition: width 35ms ease;\n"]);return y=function(){return e},e}function k(){var e=Object(v.a)(["\n  border-radius: 4px;\n  display: block;\n  height: 8px;\n  overflow: hidden;\n  position: relative;\n  top: 16px;\n  width: 100%;\n"]);return k=function(){return e},e}function T(){var e=Object(v.a)(["\n  height: 40px;\n  position: relative;\n  width: 100%;\n"]);return T=function(){return e},e}var w=O.a.div(T()),R=O.a.div(k()),S=O.a.div(y()),C=O.a.div(j()),x=O.a.div(E()),_=function(e){function t(){return Object(h.a)(this,t),Object(m.a)(this,Object(g.a)(t).apply(this,arguments))}return Object(b.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this.props,t=e.width,n=e.threshold,a=e.handleMouse;return o.a.createElement(w,null,o.a.createElement(R,{style:{background:"rgb(105, 196, 154) none repeat scroll 0% 0%"}},o.a.createElement(S,{style:{width:n+"%",background:"rgb(251, 184, 72) none repeat scroll 0% 0%"}})),o.a.createElement(R,{style:{position:"absolute",top:"16px",background:"transparent"}},o.a.createElement(S,{style:{width:t+"%"}})),o.a.createElement(C,{onMouseDown:a},o.a.createElement(x,{onMouseDown:a,style:{left:n+"%"}})))}}]),t}(o.a.Component),M=n(189),N=n(170),L=n.n(N),A=function(){return{type:"ON_CONNECT"}},P=function(e){return{type:"TRANSCRIPT_GOOGLE",transcript_google:e}},U=function(e){return{type:"TRANSCRIPT_KALDI",transcript_kaldi:e}},D=function(e,t,n,a){return{type:"STOP_STREAM",google:e,kaldi:t,proba:n,text:a.text,url:a.url}},I=function(){return{type:"CLEAR_RESPONSES"}},B=n(106),G=function(e){function t(){var e,n;Object(h.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(m.a)(this,(e=Object(g.a)(t)).call.apply(e,[this].concat(o)))).state={context:new AudioContext},n.componentDidMount=function(){var e=n.props,t=e.stream,a=e.on_connect,o=n.state.context;n.socket=L()("wss://vawsr.mino.tw/ws"),a(),n.processor=o.createScriptProcessor(2048,1,1),n.sampleRate=o.sampleRate,n.processor.connect(o.destination),n.input=o.createMediaStreamSource(t),n.input.connect(n.processor),n.processor.onaudioprocess=function(e){n.props.record&&n.microphoneProcess(e)},n.registerEvents()},n.componentDidUpdate=function(e){var t=n.props.record;e.record!==t&&(t||n.stopRecording())},n.registerEvents=function(){n.socket.on("google_speech_data",function(e){var t=e.transcript;(0,n.props.update_google)(t)}),n.socket.on("kaldi_speech_data",function(e){var t=e.transcript;(0,n.props.update_kaldi)(Object(B.tify)(t.replace(/ /g,"")))}),n.socket.on("stop_stream",function(e){var t=e.google,a=e.kaldi,o=e.proba,r=e.result;(0,n.props.stop_stream)(t,Object(B.tify)(a.replace(/ /g,"")),o,r)})},n.stopRecording=function(){n.socket.emit("stop_stream","")},n.microphoneProcess=function(e){var t,a=e.inputBuffer.getChannelData(0);t=n.sampleRate>44100?n.downsampleBuffer(a,n.sampleRate,44100):n.convertoFloat32ToInt16(a),n.socket.emit("binary_data",t)},n.convertoFloat32ToInt16=function(e){for(var t=e.length,n=new Int16Array(t);t--;)n[t]=32767*e[t];return n.buffer},n.downsampleBuffer=function(e,t,n){if(n===t)return e;if(n>t)throw Error("downsampling rate show be smaller than original sample rate");for(var a=t/n,o=Math.round(e.length/a),r=new Int16Array(o),i=0,s=0;i<r.length;){for(var c=Math.round((i+1)*a),l=0,u=0,d=s;d<c&&d<e.length;d++)l+=e[d],u++;r[i]=32767*Math.min(1,l/u),i++,s=c}return r.buffer},n}return Object(b.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){return o.a.createElement("div",null)}}]),t}(o.a.Component),W=Object(s.b)(function(e){return{record:e.Recorder.record,stream:e.Recorder.stream}},function(e){return Object(c.a)({on_connect:A,update_google:P,update_kaldi:U,stop_stream:D},e)})(G),q=function(){return{type:"START_RECORD"}},V=function(){return{type:"STOP_RECORD"}},H=function(e){return{type:"UPDATE_STREAM",stream:e}},X=function(){return{type:"RESUME_VOLUMEMETER"}},F=function(){return{type:"SUSPEND_VOLUMEMETER"}},z=function(e){function t(e){var n;return Object(h.a)(this,t),(n=Object(m.a)(this,Object(g.a)(t).call(this,e))).loop=function(){var e=n.props,t=e.startRecord,a=e.stopRecord,o=e.record,r=e.logined,i=e.suspended,s=e.hasivector,c=n.state,l=c.stream,u=c.threshold,d=c.stopTimeout;if(r&&l&&s)if(i)a();else{n.analyser.getByteTimeDomainData(n.array);for(var p,h,f,m,g=0,b=0;b<n.array.length;)g+=(h=n.array[b++]/128-1)*h;if(f=Math.sqrt(g/n.array.length),m=20*Math.log10(f),p=100+2.083*(m=Math.max(-48,Math.min(m,0))),n.setState({volume:Number(p.toFixed(2))}),p>=u)n.setState({stopTimeout:0}),o||t();else{if(!o)return;d>20?(n.setState({stopTimeout:0}),a()):n.setState(function(e){return{stopTimeout:e.stopTimeout+1}})}}},n.handleMouse=function(){document.addEventListener("mousemove",n.handleMouseMove,!0),document.addEventListener("mouseup",n.handleMouseUp,!0)},n.handleMouseMove=function(e){var t;t=e.clientX<n.node.offsetLeft?0:e.clientX>n.node.offsetWidth+n.node.offsetLeft?n.node.offsetWidth/n.node.clientWidth*100:(e.clientX-n.node.offsetLeft)/n.node.clientWidth*100,n.setState({threshold:t})},n.handleMouseUp=function(e){var t;document.removeEventListener("mousemove",n.handleMouseMove,!0),document.removeEventListener("mouseup",n.handleMouseUp,!0),t=e.clientX<n.node.offsetLeft?0:e.clientX>n.node.offsetWidth+n.node.offsetLeft?n.node.offsetWidth/n.node.clientWidth*100:(e.clientX-n.node.offsetLeft)/n.node.clientWidth*100,n.setState({threshold:t}),n.cookie.set("threshold",t)},window.AudioContext=window.AudioContext||window.webkitAudioContext,n.state={audioContext:new AudioContext,src:null,volume:0,threshold:50,stream:!1,stopTimeout:0},n.cookie=new M.a,n}return Object(b.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.updateStream;navigator.mediaDevices.getUserMedia({audio:!0}).then(function(n){t(n),e.setState(function(e){return{src:e.audioContext.createMediaStreamSource(n),stream:n}}),e.setupAnalyser()});var n=this.cookie.get("threshold");void 0!==n&&Number(n)&&this.setState({threshold:Number(n)})}},{key:"setupAnalyser",value:function(){var e=this.state,t=e.audioContext,n=e.src;this.analyser=t.createAnalyser(),n.connect(this.analyser),this.array=new Uint8Array(this.analyser.frequencyBinCount),setInterval(this.loop,100)}},{key:"render",value:function(){var e=this,t=this.state,n=t.volume,a=t.threshold,r=t.stream,i=this.props.logined;return o.a.createElement("div",{ref:function(t){return e.node=t}},o.a.createElement(_,{handleMouse:this.handleMouse,threshold:a,width:n}),i&&r&&o.a.createElement(W,null))}}]),t}(o.a.Component),K=Object(s.b)(function(e){return{record:e.Recorder.record,suspended:e.Recorder.suspended,logined:e.LoginManager.logined,hasivector:e.LoginManager.hasivector}},function(e){return Object(c.a)({startRecord:q,stopRecord:V,updateStream:H},e)})(z),J=n(40),Q=n(78),Y=n.n(Q),$=n(79),Z=n.n($),ee=n(52),te=n.n(ee),ne=n(39),ae=n.n(ne),oe=n(51),re=n.n(oe),ie=n(107),se=n.n(ie),ce=n(27),le=n(185),ue=n.n(le),de=n(109),pe=n.n(de),he=n(108),fe=n.n(he),me=n(25),ge=n(171),be=n.n(ge),ve=function(e){return{type:"LOGIN",fbid:e.fbid,email:e.email,name:e.name,hasivector:e.hasivector,processing:e.processing}},Oe=function(){return{type:"LOGOUT"}},Ee=function(e,t){return{type:"UPDATE_STATUS",hasivector:e,processing:t}},je=n(50),ye=n.n(je),ke=n(177),Te=n.n(ke),we=n(182),Re=n.n(we),Se=n(183),Ce=n.n(Se),xe=n(181),_e=n.n(xe),Me=n(184),Ne=n.n(Me),Le=n(178),Ae=n.n(Le),Pe=n(175),Ue=n.n(Pe),De=n(180),Ie=n.n(De),Be=n(176),Ge=n.n(Be),We=n(37),qe=n.n(We),Ve=n(179),He=n.n(Ve),Xe=n(174),Fe=n.n(Xe),ze=n(173),Ke=n.n(ze),Je=n(172),Qe=n.n(Je),Ye=function(e){function t(e){var n;return Object(h.a)(this,t),(n=Object(m.a)(this,Object(g.a)(t).call(this,e))).componentDidMount=function(){var e=n.props.stream;n.recorder=new Qe.a(e),n.recorder.mimeType="audio/wav",n.recorder.audioChannels=1,n.recorder.bufferSize=2048,n.recorder.ondataavailable=function(e){n.props.handleURL(e)},n.setState({ready:!0})},n.startRecording=function(){n.setState({record:!0}),n.recorder.start(1e5)},n.stopRecording=function(){n.setState({record:!1}),n.recorder.stop()},n.state={record:!1,ready:!1},n}return Object(b.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this.props.classes;return o.a.createElement("div",{className:e.record},o.a.createElement(ye.a,{className:e.button,variant:"fab",color:"secondary",onClick:this.state.record?this.stopRecording:this.startRecording,type:"button",disabled:!this.state.ready},this.state.record?o.a.createElement(Ke.a,null):o.a.createElement(Fe.a,null)))}}]),t}(o.a.Component),$e=Object(s.b)(function(e){return{stream:e.Recorder.stream}})(Object(ce.withStyles)(function(e){return{button:{margin:e.spacing.unit,float:"right"},record:{margin:"10px 0px"}}})(Ye));function Ze(e){return o.a.createElement(Ge.a,Object.assign({direction:"up"},e))}var et=function(e){function t(){var e,n;Object(h.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(m.a)(this,(e=Object(g.a)(t)).call.apply(e,[this].concat(o)))).state={open:!1,sentences:[],audioBlob:{},audio:[],step:0,loading:!1},n.handleClick=function(){(0,n.props.suspend)(),n.generateSentences(),n.setState({open:!0})},n.handleClose=function(){var e=n.props,t=e.callback;(0,e.resume)(),n.setState({open:!1}),t()},n.handleBack=function(){n.state.step>0?n.setState(function(e){return{step:e.step-1}}):n.handleClose()},n.handleNext=function(){if(n.state.step<9)n.setState(function(e){return{step:e.step+1}});else{var e=n.props,t=e.hostname,a=e.update_status;n.setState({loading:!0});for(var o=new FormData,r=0;r<10;r++)o.append("file".concat(r+1),n.state.audioBlob[r],"file".concat(r+1,".wav"));qe.a.post("".concat(t,"/registerspeaker"),o,{headers:{"Content-Type":"multipart/form-data"}}).then(function(e){return e.data}).then(function(e){var t=e.message;me.toast.success(t),a(!1,!0),n.handleClose()}).catch(function(e){me.toast.error(e.response.data.message),n.setState({loading:!1})})}},n.handleURL=function(e){var t={};t[n.state.step]=e,n.setState(function(e){return{audioBlob:Object.assign({},e.audioBlob,t)}})},n.replayBlob=function(){var e=window.URL.createObjectURL(n.state.audioBlob[n.state.step]);new Audio(e).play()},n.generateSentences=function(){var e=n.props.hostname;qe.a.get("".concat(e,"/sentences.json")).then(function(e){return e.data}).then(function(e){var t=e.sentences;n.setState({sentences:t})}).catch(function(){me.toast.error("\u53d6\u5f97\u8a9e\u6599\u5931\u6557\uff0c\u8acb\u6aa2\u67e5\u767b\u5165\u662f\u5426\u904e\u671f"),n.handleClose()})},n}return Object(b.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,n=e.hasivector,a=e.processing,r=this.state,i=r.loading,s=r.step,c=r.sentences,l=r.audioBlob,u=r.open;return o.a.createElement("div",null,o.a.createElement(re.a,{onClick:this.handleClick,disabled:a},o.a.createElement("p",null,n?"\u91cd\u65b0\u8a3b\u518a\u8a9e\u8005":"\u8a9e\u8005\u8a2d\u5b9a")),o.a.createElement(Te.a,{fullScreen:!0,open:u,onClose:this.handleClose,TransitionComponent:Ze},o.a.createElement(Y.a,{className:t.appBar},o.a.createElement(Z.a,null,o.a.createElement(te.a,{color:"inherit",onClick:this.handleClose,"aria-label":"Close"},o.a.createElement(Ae.a,null)),o.a.createElement(ae.a,{variant:"h6",color:"inherit",className:t.flex},"\u8a9e\u8005\u8a2d\u5b9a"),o.a.createElement(He.a,{className:t.dots,variant:"dots",steps:10,position:"static",activeStep:s,backButton:o.a.createElement(ye.a,{onClick:this.handleBack,color:"inherit"},"Back"),nextButton:o.a.createElement(ye.a,{onClick:this.handleNext,color:"inherit",autoFocus:!0,disabled:!l[s]||i},9===s?"Finish":"Next",i&&o.a.createElement(Ie.a,{size:24,className:t.buttonProgress}))}))),o.a.createElement(_e.a,{id:"responsive-dialog-title"},"\u8acb\u6717\u8b80\u4e0b\u5217\u6587\u5b57\u9032\u884c\u8a9e\u8005\u8a3b\u518a"),o.a.createElement(Re.a,null,o.a.createElement(Ce.a,{id:"sentences"},c[s]),o.a.createElement($e,{handleURL:this.handleURL}),o.a.createElement(ye.a,{disabled:!l[s],className:t.button,variant:"fab",color:"secondary",type:"button",onClick:this.replayBlob},o.a.createElement(Ne.a,null)))))}}]),t}(o.a.Component),tt=Object(s.b)(function(e){return{processing:e.LoginManager.processing,hasivector:e.LoginManager.hasivector,hostname:e.Host.hostname}},function(e){return Object(c.a)({resume:X,suspend:F,update_status:Ee},e)})(Object(ce.withStyles)(function(e){return{dots:{backgroundColor:"inherit"},button:{margin:e.spacing.unit,float:"right"},buttonProgress:{color:Ue.a[500],position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12},appBar:{position:"relative"},flex:{flex:1}}})(et));qe.a.defaults.withCredentials=!0;var nt=function(e){function t(e){var n;Object(h.a)(this,t),(n=Object(m.a)(this,Object(g.a)(t).call(this,e))).state={anchorEl:null,anchorEl2:null},n.handleProfileMenuOpen=function(e){n.setState({anchorEl:e.currentTarget})},n.handleProfileMenuOpen2=function(e){n.setState({anchorEl2:e.currentTarget})},n.handleMenuClose=function(){n.setState({anchorEl:null,anchorEl2:null})},n.handleLogin=function(e){var t=n.props,a=t.hostname,o=t.login;qe.a.post("".concat(a,"/login"),{email:e.email,name:e.name,token:e.accessToken,signed:e.signedRequest,fbid:Number(e.id)},{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){return e.data}).then(function(e){o(e),me.toast.success("Login success",{position:me.toast.POSITION.BOTTOM_RIGHT})}).catch(function(){return me.toast.error("Login failed",{position:me.toast.POSITION.BOTTOM_RIGHT})}).finally(function(){n.handleMenuClose()})},n.handleLogout=function(){var e=n.props,t=e.logout,a=e.hostname;qe.a.get("".concat(a,"/logout")),t(),me.toast.warn("Logout success",{position:me.toast.POSITION.BOTTOM_RIGHT}),n.handleMenuClose()},n.handleClearResponses=function(){(0,n.props.clear_responses)(),n.handleMenuClose()};var a=n.props,o=a.hostname,r=a.login;return qe.a.get("".concat(o,"/auth")).then(function(e){return e.data}).then(function(e){r(e),console.log("Auth success")}).catch(function(){console.log("Auth failed")}),n}return Object(b.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this.state,t=e.anchorEl,n=e.anchorEl2,a=this.props,r=a.classes,i=a.logined,s=a.stream,c=a.user,l=Boolean(t),u=Boolean(n),d=o.a.createElement(se.a,{anchorEl:t,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},open:l,onClose:this.handleMenuClose},i?o.a.createElement(re.a,{onClick:this.handleLogout},"Logout"):o.a.createElement(be.a,{appId:"332358063993706",fields:"name,email,picture",disableMobileRedirect:!0,callback:this.handleLogin,render:function(e){return o.a.createElement(re.a,{onClick:e.onClick},"Facebook Login")}}),i&&o.a.createElement(tt,{callback:this.handleMenuClose})),p=o.a.createElement(se.a,{anchorEl:n,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},open:u,onClose:this.handleMenuClose},o.a.createElement(re.a,{onClick:this.handleClearResponses},"\u6e05\u7406\u8a0a\u606f"));return o.a.createElement("div",{className:r.root},o.a.createElement(Y.a,{position:"static"},o.a.createElement(Z.a,null,o.a.createElement(te.a,{"aria-owns":u?"material-appbar":null,"aria-haspopup":"true",className:r.menuButton,onClick:this.handleProfileMenuOpen2,color:"inherit","aria-label":"Open drawer"},o.a.createElement(ue.a,null)),o.a.createElement(ae.a,{className:r.title,variant:"h6",color:"inherit",noWrap:!0},"\u5177\u8a9e\u8005\u8fa8\u8b58\u4e4b\u8a9e\u97f3\u52a9\u7406"),o.a.createElement("div",{className:r.grow}),o.a.createElement("div",{className:r.sectionDesktop},o.a.createElement(te.a,{"aria-owns":l?"material-appbar":null,"aria-haspopup":"true",onClick:this.handleProfileMenuOpen,color:"inherit"},c.fbid?o.a.createElement(fe.a,{alt:c.name,src:"https://graph.facebook.com/".concat(c.fbid,"/picture?type=normal")}):o.a.createElement(pe.a,null))),o.a.createElement("div",{className:r.sectionMobile},o.a.createElement(te.a,{"aria-owns":l?"material-appbar":null,"aria-haspopup":"true",onClick:this.handleProfileMenuOpen,color:"inherit"},c.fbid?o.a.createElement(fe.a,{alt:c.name,src:"https://graph.facebook.com/".concat(c.fbid,"/picture?type=normal")}):o.a.createElement(pe.a,null))))),s&&d,p)}}]),t}(o.a.Component),at=Object(s.b)(function(e){return{logined:e.LoginManager.logined,hostname:e.Host.hostname,user:e.LoginManager,stream:e.Recorder.stream}},function(e){return Object(c.a)({login:ve,logout:Oe,clear_responses:I},e)})(Object(ce.withStyles)(function(e){return{root:{width:"100%"},grow:{flexGrow:1},menuButton:{marginLeft:-12,marginRight:20},title:{display:"block"},sectionDesktop:Object(J.a)({display:"none"},e.breakpoints.up("md"),{display:"flex"}),sectionMobile:Object(J.a)({display:"flex"},e.breakpoints.up("md"),{display:"none"})}})(nt));function ot(){var e=Object(v.a)(["\n  margin: 0px;\n  margin-bottom: 10px;\n"]);return ot=function(){return e},e}var rt=O.a.p(ot()),it=function(e){function t(){return Object(h.a)(this,t),Object(m.a)(this,Object(g.a)(t).apply(this,arguments))}return Object(b.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){return o.a.createElement("footer",null,o.a.createElement(rt,null,"\xa9 YunTech 2018"))}}]),t}(o.a.Component),st=n(110),ct=n(5),lt=n.n(ct),ut=n(82),dt=n.n(ut),pt=n(81),ht=n.n(pt),ft=n(80),mt=n(186),gt=n.n(mt),bt=function(e){function t(){var e,n;Object(h.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(m.a)(this,(e=Object(g.a)(t)).call.apply(e,[this].concat(o)))).handleClick=function(){var e=n.props.url;e&&window.open(e,"_blank")},n}return Object(b.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,n=e.google,a=e.kaldi,r=e.proba,i=e.text,s=e.url;return o.a.createElement("div",null,n&&o.a.createElement("div",{className:t.flex},o.a.createElement(ht.a,{className:t.margin,label:"Google",defaultValue:n,variant:"outlined",multiline:!0,InputProps:{startAdornment:o.a.createElement(dt.a,{position:"start"},o.a.createElement(ft.a,{icon:["fab","google"]})),readOnly:!0}})),a&&o.a.createElement("div",{className:t.flex},o.a.createElement(ht.a,{className:t.margin,label:"Kaldi",defaultValue:a,multiline:!0,variant:"outlined",InputProps:{startAdornment:o.a.createElement(dt.a,{position:"start"},o.a.createElement(ft.a,{className:t.k_margin,icon:["fab","kaggle"]})),readOnly:!0}})),i&&o.a.createElement("div",{className:t.flexRight},o.a.createElement(ht.a,{className:lt()(t.margin,t.marginLeft),label:"The probability: ".concat(r),defaultValue:i+s,multiline:!0,variant:"outlined",onClick:this.handleClick,InputProps:{startAdornment:o.a.createElement(dt.a,{position:"start"},o.a.createElement(ft.a,{icon:["fas","robot"]})),readOnly:!0}})),i&&o.a.createElement(gt.a,{className:t.clear}))}}]),t}(a.Component),vt=Object(ce.withStyles)(function(e){return{flex:{display:"flex",flexWrap:"wrap"},flexRight:{display:"flex"},clear:{clear:"both"},margin:Object(J.a)({margin:e.spacing.unit,width:"80%"},e.breakpoints.up("md"),{width:"40%"}),marginLeft:{"margin-left":"auto"},k_margin:{"margin-left":"3px","margin-right":"3px"}}})(bt);function Ot(){var e=Object(v.a)(["\n  width: 100%;\n  height: calc(100vh - 132px);\n  overflow: scroll;\n  overflow-x: hidden;\n  border-radius: 10px;\n  background: #eee;\n"]);return Ot=function(){return e},e}var Et=O.a.div(Ot()),jt=function(e){function t(e){var n;Object(h.a)(this,t);var a=(n=Object(m.a)(this,Object(g.a)(t).call(this,e))).props.responses;return n.responses=Object(st.a)(a),n.responsesItem=a.map(function(e,t){return o.a.createElement(vt,Object.assign({key:t},e))}),n}return Object(b.a)(t,e),Object(f.a)(t,[{key:"scrollToBottom",value:function(){this.el.scrollTop=this.el.scrollTopMax+100}},{key:"componentDidUpdate",value:function(){this.scrollToBottom()}},{key:"render",value:function(){var e=this,t=this.props,n=t.google,a=t.kaldi,r=t.responses,i=this.responsesItem;if(r.length>this.responses.length){for(var s=this.responses.length;s<r.length;s++)i.push(o.a.createElement(vt,Object.assign({key:s},r[s])));this.responses=Object(st.a)(r)}else r<this.responses&&(this.responses=[],this.responsesItem=[],i=[]);return o.a.createElement(Et,{innerRef:function(t){e.el=t}},i,o.a.createElement(vt,{google:n,kaldi:a,proba:0,text:"",url:""}))}}]),t}(a.Component),yt=Object(s.b)(function(e){return{google:e.Websocket.google,kaldi:e.Websocket.kaldi,responses:e.Websocket.responses}})(jt);n(419);function kt(){var e=Object(v.a)(["\n  text-align: center;\n  margin: 0px auto;\n"]);return kt=function(){return e},e}var Tt=O.a.div(kt()),wt=function(e){function t(){return Object(h.a)(this,t),Object(m.a)(this,Object(g.a)(t).apply(this,arguments))}return Object(b.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){return o.a.createElement(Tt,{id:"app"},o.a.createElement(at,null),o.a.createElement(yt,null),o.a.createElement(K,null),o.a.createElement(it,null),o.a.createElement(me.ToastContainer,null))}}]),t}(a.Component),Rt=n(423),St=n(60),Ct=n(187),xt=n(188);St.b.add(Ct.a,xt.a);var _t=Object(ce.createMuiTheme)({typography:{useNextVariants:!0}}),Mt=Object(c.c)(p,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__());i.a.render(o.a.createElement(s.a,{store:Mt},o.a.createElement(ce.MuiThemeProvider,{theme:_t},o.a.createElement(Rt.a,null,o.a.createElement(wt,null)))),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("/VAWSR",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat("/VAWSR","/service-worker.js");l?(function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):u(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):u(e)})}}()},59:function(e,t,n){"use strict";n.r(t);var a=n(8);t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{logined:!1,hasivector:!1,processing:!1},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN":return{fbid:t.fbid,email:t.email,name:t.name,logined:!0,processing:t.processing,hasivector:t.hasivector};case"LOGOUT":return{logined:!1,hasivector:!1,processing:!1};case"UPDATE_STATUS":return Object(a.a)({},e,{processing:t.processing?t.processing:e.processing,hasivector:t.hasivector?t.hasivector:e.hasivector});default:return e}}},77:function(e,t,n){"use strict";n.r(t);t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{hostname:"https://vawsr.mino.tw"},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CHANGE_HOST":return Object.assign({},e,{hostname:t.hostname});default:return e}}}},[[190,2,1]]]);
//# sourceMappingURL=main.cf39cfc1.chunk.js.map